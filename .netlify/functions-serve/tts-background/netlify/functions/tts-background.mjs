
import {createRequire as ___nfyCreateRequire} from "module";
import {fileURLToPath as ___nfyFileURLToPath} from "url";
import {dirname as ___nfyPathDirname} from "path";
let __filename=___nfyFileURLToPath(import.meta.url);
let __dirname=___nfyPathDirname(___nfyFileURLToPath(import.meta.url));
let require=___nfyCreateRequire(import.meta.url);


// netlify/functions/tts-background.mjs
import OpenAI from "openai";
import FormData from "form-data";
import fetch from "node-fetch";
import { JSDOM } from "jsdom";
var DIRECTUS_URL = process.env.DIRECTUS_URL;
var DIRECTUS_AUTH_TOKEN = process.env.DIRECTUS_AUTH_TOKEN;
var openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY
});
async function directusFetch(endpoint, method = "GET", body = null) {
  const url = `${DIRECTUS_URL}${endpoint}`;
  const headers = {
    "Authorization": `Bearer ${DIRECTUS_AUTH_TOKEN}`,
    "Content-Type": "application/json"
  };
  const options = {
    method,
    headers
  };
  if (body) {
    options.body = JSON.stringify(body);
  }
  const response = await fetch(url, options);
  if (!response.ok) {
    const errorDetails = await response.text();
    throw new Error(`Directus API request failed: ${response.status} - ${errorDetails}`);
  }
  return response.json();
}
async function readDirectusItem(collection, itemId) {
  const endpoint = `/items/${collection}/${itemId}?fields=*.*,authors.team_id.*`;
  return directusFetch(endpoint);
}
async function runProcess(bodyres) {
  try {
    let getFullName = function(author) {
      return `${author.team_id.First_Name} ${author.team_id.Last_Name}`;
    }, joinAuthorNames = function(authors2) {
      if (authors2.length === 1) {
        return getFullName(authors2[0]);
      } else {
        return authors2.map(getFullName).join(", ").replace(/, (?=[^,]+$)/, " and ");
      }
    };
    const article = await readDirectusItem(bodyres.collection, bodyres.id);
    console.log("Retrieved article:", article);
    const { content, slug, title, authors } = article.data;
    let textContent = `${title} 
by ${joinAuthorNames(authors)} 
${extractTextFromHTML(content)}`;
    console.log(textContent);
    let allSpeechBuffers = [];
    if (textContent.length > 4096) {
      const chunks = splitText(textContent, 4096);
      for (const chunk of chunks) {
        console.log(chunk.length);
        const buffer = await generateSpeech(chunk);
        allSpeechBuffers.push(buffer);
      }
    } else {
      const buffer = await generateSpeech(textContent);
      allSpeechBuffers.push(buffer);
    }
    const combinedBuffer = Buffer.concat(allSpeechBuffers);
    const uploadResult = await uploadBuffer(combinedBuffer, slug, bodyres.collection, bodyres.id);
    const updateResult = await updateArticleWithAudioId(bodyres.collection, bodyres.id, uploadResult.data.id);
    return updateResult;
  } catch (error) {
    console.error("Error in processing article and generating speech:", error);
  }
}
async function generateSpeech(text) {
  const response = await openai.audio.speech.create({
    model: "tts-1-hd",
    voice: "shimmer",
    input: text
  });
  if (response.status !== 200) {
    throw new Error("Failed to generate speech from OpenAI.");
  }
  const chunks = [];
  for await (const chunk of response.body) {
    chunks.push(chunk instanceof Buffer ? chunk : Buffer.from(chunk));
  }
  return Buffer.concat(chunks);
}
async function uploadBuffer(buffer, slug, collection, collection_id) {
  const form = new FormData();
  form.append("file", buffer, {
    filename: slug + ".mp3",
    contentType: "audio/mpeg",
    knownLength: buffer.length
  });
  const directusFileEndpoint = DIRECTUS_URL + "/files";
  const headers = {
    "Authorization": "Bearer " + DIRECTUS_AUTH_TOKEN
    // replace with an actual token
  };
  const finalHeaders = { ...form.getHeaders(), ...headers };
  const fileResponse = await fetch(directusFileEndpoint, {
    method: "POST",
    body: form,
    headers: finalHeaders
  });
  if (!fileResponse.ok) {
    const errorBody = await fileResponse.text();
    throw new Error(`Error uploading file: ${errorBody}`);
  }
  const directusResponse = await fileResponse.json();
  return directusResponse;
}
async function updateArticleWithAudioId(collection, itemId, audioFileId) {
  const directusItemEndpoint = DIRECTUS_URL + "/items/" + collection + "/" + itemId;
  const updateData = {
    audio_version: audioFileId
  };
  const headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer " + DIRECTUS_AUTH_TOKEN
  };
  const response = await fetch(directusItemEndpoint, {
    method: "PATCH",
    body: JSON.stringify(updateData),
    headers
  });
  if (!response.ok) {
    const errorBody = await response.text();
    throw new Error(`Error updating item: ${errorBody}`);
  }
  const jsonResponse = await response.json();
  return jsonResponse;
}
var tts_background_default = async (req, context) => {
  const bodyres = await req.json();
  console.log(bodyres);
  await runProcess(bodyres);
};
function extractTextFromHTML(html) {
  const dom = new JSDOM(html);
  const document = dom.window.document;
  function walkNode(node, text = "") {
    if (node.nodeType === 1 && ["SCRIPT", "STYLE", "IMG", "FIGCAPTION"].includes(node.tagName)) {
      return text;
    }
    if (node.nodeType === 3) {
      text += node.textContent;
    } else if (node.nodeType === 1) {
      if (["P", "BR", "DIV", "LI", "H1", "H2", "H3", "H4", "H5", "H6"].includes(node.tagName)) {
        text += node.textContent + "\n";
      } else {
        for (const childNode of node.childNodes) {
          text = walkNode(childNode, text);
        }
      }
    }
    return text;
  }
  return walkNode(document.body);
}
function splitText(text, maxLength) {
  const sentenceEndings = [".", "!", "?"];
  let chunks = [];
  let startIndex = 0;
  while (startIndex < text.length) {
    let endIndex = Math.min(startIndex + maxLength, text.length);
    let lastBreakIndex = startIndex;
    for (let i = startIndex; i < endIndex; i++) {
      if (text[i] === "\n" || sentenceEndings.includes(text[i]) && text[i + 1] && text[i + 1] === " ") {
        lastBreakIndex = i + 1;
      }
    }
    if (lastBreakIndex > startIndex) {
      chunks.push(text.substring(startIndex, lastBreakIndex));
      startIndex = lastBreakIndex;
    } else {
      let nextBreakIndex = text.indexOf("\n", endIndex) || text.length;
      for (const ending of sentenceEndings) {
        let nextSentenceIndex = text.indexOf(ending + " ", endIndex);
        if (nextSentenceIndex !== -1 && (nextSentenceIndex < nextBreakIndex || nextBreakIndex === -1)) {
          nextBreakIndex = nextSentenceIndex + 1;
        }
      }
      nextBreakIndex = nextBreakIndex !== -1 ? nextBreakIndex : text.length;
      chunks.push(text.substring(startIndex, nextBreakIndex));
      startIndex = nextBreakIndex;
    }
  }
  return chunks;
}
export {
  tts_background_default as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibmV0bGlmeS9mdW5jdGlvbnMvdHRzLWJhY2tncm91bmQubWpzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgT3BlbkFJIGZyb20gJ29wZW5haSc7XG5pbXBvcnQgRm9ybURhdGEgZnJvbSAnZm9ybS1kYXRhJztcbmltcG9ydCBmZXRjaCBmcm9tICdub2RlLWZldGNoJztcbmltcG9ydCB7IEpTRE9NIH0gZnJvbSAnanNkb20nO1xuXG4vLyBDb25maWd1cmF0aW9uIHZhcmlhYmxlc1xuY29uc3QgRElSRUNUVVNfVVJMID0gcHJvY2Vzcy5lbnYuRElSRUNUVVNfVVJMXG5jb25zdCBESVJFQ1RVU19BVVRIX1RPS0VOID0gcHJvY2Vzcy5lbnYuRElSRUNUVVNfQVVUSF9UT0tFTlxuXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcbiAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSxcbn0pO1xuXG5cblxuLy8gRnVuY3Rpb24gdG8gbWFrZSByZXF1ZXN0cyB0byBEaXJlY3R1cyBBUElcbmFzeW5jIGZ1bmN0aW9uIGRpcmVjdHVzRmV0Y2goZW5kcG9pbnQsIG1ldGhvZCA9ICdHRVQnLCBib2R5ID0gbnVsbCkge1xuICBjb25zdCB1cmwgPSBgJHtESVJFQ1RVU19VUkx9JHtlbmRwb2ludH1gO1xuICBjb25zdCBoZWFkZXJzID0ge1xuICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke0RJUkVDVFVTX0FVVEhfVE9LRU59YCxcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICB9O1xuXG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgbWV0aG9kLFxuICAgIGhlYWRlcnMsXG4gIH07XG5cbiAgaWYgKGJvZHkpIHtcbiAgICBvcHRpb25zLmJvZHkgPSBKU09OLnN0cmluZ2lmeShib2R5KTtcbiAgfVxuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCBvcHRpb25zKTtcblxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgY29uc3QgZXJyb3JEZXRhaWxzID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIHRocm93IG5ldyBFcnJvcihgRGlyZWN0dXMgQVBJIHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c30gLSAke2Vycm9yRGV0YWlsc31gKTtcbiAgfVxuXG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5cbi8vIEZ1bmN0aW9uIHRvIHJlYWQgYW4gaXRlbSBmcm9tIGEgY29sbGVjdGlvbiBieSBJRFxuYXN5bmMgZnVuY3Rpb24gcmVhZERpcmVjdHVzSXRlbShjb2xsZWN0aW9uLCBpdGVtSWQpIHtcbiAgY29uc3QgZW5kcG9pbnQgPSBgL2l0ZW1zLyR7Y29sbGVjdGlvbn0vJHtpdGVtSWR9P2ZpZWxkcz0qLiosYXV0aG9ycy50ZWFtX2lkLipgO1xuICByZXR1cm4gZGlyZWN0dXNGZXRjaChlbmRwb2ludCk7XG59XG5cblxuLy8gTWFpbiBmdW5jdGlvbiB0byBydW4gdGhlIHByb2Nlc3NcbmFzeW5jIGZ1bmN0aW9uIHJ1blByb2Nlc3MoYm9keXJlcykge1xuICB0cnkge1xuICAgIC8vIFJlYWQgYW4gaXRlbSBmcm9tIHRoZSBEaXJlY3R1cyBjb2xsZWN0aW9uIHdpdGggdGhlIHNwZWNpZmllZCBJRFxuICAgIGNvbnN0IGFydGljbGUgPSBhd2FpdCByZWFkRGlyZWN0dXNJdGVtKGJvZHlyZXMuY29sbGVjdGlvbiwgYm9keXJlcy5pZCk7XG4gICAgY29uc29sZS5sb2coJ1JldHJpZXZlZCBhcnRpY2xlOicsIGFydGljbGUpO1xuXG4gICAgLy8gRXh0cmFjdCB0aGUgY29udGVudCBhbmQgZGF0ZSB1cGRhdGVkIGZyb20gdGhlIGFydGljbGVcbiAgICBjb25zdCB7IGNvbnRlbnQsIHNsdWcsIHRpdGxlICwgYXV0aG9ycyAgIH0gPSBhcnRpY2xlLmRhdGE7XG5cbiAgICAvLyBGdW5jdGlvbiB0byBleHRyYWN0IHRoZSBmdWxsIG5hbWUgZnJvbSBhbiBhdXRob3Igb2JqZWN0XG4gICAgICBmdW5jdGlvbiBnZXRGdWxsTmFtZShhdXRob3IpIHtcbiAgICAgICAgcmV0dXJuIGAke2F1dGhvci50ZWFtX2lkLkZpcnN0X05hbWV9ICR7YXV0aG9yLnRlYW1faWQuTGFzdF9OYW1lfWA7XG4gICAgICB9XG5cbiAgICAgIC8vIEZ1bmN0aW9uIHRvIGpvaW4gYXV0aG9yIG5hbWVzIHdpdGggY29tbWFzIGFuZCBcImFuZFwiXG4gICAgICBmdW5jdGlvbiBqb2luQXV0aG9yTmFtZXMoYXV0aG9ycykge1xuICAgICAgICBpZiAoYXV0aG9ycy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAvLyBPbmx5IG9uZSBhdXRob3IsIHNvIGp1c3QgcmV0dXJuIHRoZSBmdWxsIG5hbWVcbiAgICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUoYXV0aG9yc1swXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gSm9pbiBtdWx0aXBsZSBhdXRob3JzIHdpdGggY29tbWFzIGFuZCByZXBsYWNlIHRoZSBsYXN0IGNvbW1hIHdpdGggXCJhbmRcIlxuICAgICAgICAgIHJldHVybiBhdXRob3JzLm1hcChnZXRGdWxsTmFtZSkuam9pbignLCAnKS5yZXBsYWNlKC8sICg/PVteLF0rJCkvLCAnIGFuZCAnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG5cbiAgICBsZXQgdGV4dENvbnRlbnQgPSBgJHt0aXRsZX0gXFxuYnkgJHtqb2luQXV0aG9yTmFtZXMoYXV0aG9ycyl9IFxcbiR7ZXh0cmFjdFRleHRGcm9tSFRNTChjb250ZW50KX1gO1xuICAgIGNvbnNvbGUubG9nKHRleHRDb250ZW50KTtcbiAgICBcbiAgICAvLyBBbiBhcnJheSB0byBob2xkIGFsbCBzcGVlY2ggYnVmZmVyc1xuICAgIGxldCBhbGxTcGVlY2hCdWZmZXJzID0gW107XG4gICAgXG4gICAgLy8gQ2hlY2sgdGhlIGNvbnRlbnQgbGVuZ3RoIGFuZCBzcGxpdCBpZiBuZWNlc3NhcnlcbiAgICBpZiAodGV4dENvbnRlbnQubGVuZ3RoID4gNDA5Nikge1xuICAgICAgY29uc3QgY2h1bmtzID0gc3BsaXRUZXh0KHRleHRDb250ZW50LCA0MDk2KTtcblxuICAgLy8gUHJvY2VzcyBlYWNoIGNodW5rIHRvIGdlbmVyYXRlIHNwZWVjaFxuICAgZm9yIChjb25zdCBjaHVuayBvZiBjaHVua3MpIHtcbiAgICBjb25zb2xlLmxvZyhjaHVuay5sZW5ndGgpO1xuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGdlbmVyYXRlU3BlZWNoKGNodW5rKTtcbiAgICBhbGxTcGVlY2hCdWZmZXJzLnB1c2goYnVmZmVyKTtcbiAgfVxuXG4gICAgICAvLyBmb3IgKGNvbnN0IGNodW5rIG9mIGNodW5rcykge1xuICAgICAgLy8gICBjb25zb2xlLmxvZyhjaHVuay5sZW5ndGgpO1xuICAgICAgLy8gICBhd2FpdCBnZW5lcmF0ZUFuZFVwbG9hZFNwZWVjaChjaHVuaywgZGF0ZV91cGRhdGVkLCBib2R5cmVzKTtcbiAgICAgIC8vIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYXdhaXQgZ2VuZXJhdGVBbmRVcGxvYWRTcGVlY2godGV4dF90b19zcGVlY2gsIGRhdGVfdXBkYXRlZCwgYm9keXJlcyk7XG4gICAgICBjb25zdCBidWZmZXIgPSBhd2FpdCBnZW5lcmF0ZVNwZWVjaCh0ZXh0Q29udGVudCk7XG4gICAgICBhbGxTcGVlY2hCdWZmZXJzLnB1c2goYnVmZmVyKTtcbiAgICB9XG4gICAgIC8vIENvbmNhdGVuYXRlIGFsbCBzcGVlY2ggYnVmZmVycyBpbnRvIGEgc2luZ2xlIGJ1ZmZlclxuICAgICBjb25zdCBjb21iaW5lZEJ1ZmZlciA9IEJ1ZmZlci5jb25jYXQoYWxsU3BlZWNoQnVmZmVycyk7XG5cbiAgICAgIC8vIFVwbG9hZCBjb21iaW5lZCBidWZmZXJcbiAgICBjb25zdCB1cGxvYWRSZXN1bHQgPSBhd2FpdCB1cGxvYWRCdWZmZXIoY29tYmluZWRCdWZmZXIsIHNsdWcsIGJvZHlyZXMuY29sbGVjdGlvbiwgYm9keXJlcy5pZCk7XG4gICAgXG4gICAgICAvLyBVcGRhdGUgdGhlIGFydGljbGUgd2l0aCB0aGUgYXVkaW8gZmlsZSBJRFxuICAgICAgY29uc3QgdXBkYXRlUmVzdWx0ID0gYXdhaXQgdXBkYXRlQXJ0aWNsZVdpdGhBdWRpb0lkKGJvZHlyZXMuY29sbGVjdGlvbiwgYm9keXJlcy5pZCwgdXBsb2FkUmVzdWx0LmRhdGEuaWQpO1xuICAgICAgcmV0dXJuIHVwZGF0ZVJlc3VsdDtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHByb2Nlc3NpbmcgYXJ0aWNsZSBhbmQgZ2VuZXJhdGluZyBzcGVlY2g6JywgZXJyb3IpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlU3BlZWNoKHRleHQpIHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuYXVkaW8uc3BlZWNoLmNyZWF0ZSh7XG4gICAgbW9kZWw6IFwidHRzLTEtaGRcIixcbiAgICB2b2ljZTogXCJzaGltbWVyXCIsXG4gICAgaW5wdXQ6IHRleHQsXG4gIH0pO1xuXG4gIC8vIENoZWNrIHRoZSByZXNwb25zZSBpcyBPS1xuICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBzcGVlY2ggZnJvbSBPcGVuQUkuJyk7XG4gIH1cblxuICAvLyBDb2xsZWN0IHN0cmVhbSBkYXRhIGludG8gYSBidWZmZXIgZm9yIHRoZSBjaHVua1xuICBjb25zdCBjaHVua3MgPSBbXTtcbiAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiByZXNwb25zZS5ib2R5KSB7XG4gICAgY2h1bmtzLnB1c2goY2h1bmsgaW5zdGFuY2VvZiBCdWZmZXIgPyBjaHVuayA6IEJ1ZmZlci5mcm9tKGNodW5rKSk7XG4gIH1cbiAgcmV0dXJuIEJ1ZmZlci5jb25jYXQoY2h1bmtzKTsgLy8gUmV0dXJuIHRoZSBzaW5nbGUgc3BlZWNoIGJ1ZmZlciBmb3Igb25lIGNodW5rXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVwbG9hZEJ1ZmZlcihidWZmZXIsIHNsdWcsIGNvbGxlY3Rpb24sIGNvbGxlY3Rpb25faWQpIHtcbiAgLy8gQ3JlYXRlIGZvcm0tZGF0YSBpbnN0YW5jZVxuICBjb25zdCBmb3JtID0gbmV3IEZvcm1EYXRhKCk7XG4gIGZvcm0uYXBwZW5kKCdmaWxlJywgYnVmZmVyLCB7XG4gICAgZmlsZW5hbWU6IHNsdWcgKyAnLm1wMycsXG4gICAgY29udGVudFR5cGU6ICdhdWRpby9tcGVnJyxcbiAgICBrbm93bkxlbmd0aDogYnVmZmVyLmxlbmd0aFxuICB9KTtcblxuICBjb25zdCBkaXJlY3R1c0ZpbGVFbmRwb2ludCA9IERJUkVDVFVTX1VSTCArICcvZmlsZXMnO1xuXG4gIC8vIFByZXBhcmUgdGhlIHJlcXVlc3QgaGVhZGVycyB3aXRoIHRoZSBCZWFyZXIgdG9rZW5cbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyArIERJUkVDVFVTX0FVVEhfVE9LRU4sIC8vIHJlcGxhY2Ugd2l0aCBhbiBhY3R1YWwgdG9rZW5cbiAgfTtcblxuICAvLyBNZXJnZSB0aGUgaGVhZGVycyBmcm9tIGZvcm0tZGF0YSB3aXRoIERpcmVjdHVzIHRva2VuXG4gIGNvbnN0IGZpbmFsSGVhZGVycyA9IHsgLi4uZm9ybS5nZXRIZWFkZXJzKCksIC4uLmhlYWRlcnMgfTtcblxuICAvLyBNYWtlIHRoZSByZXF1ZXN0IHRvIERpcmVjdHVzIHRvIHVwbG9hZCB0aGUgZmlsZVxuICBjb25zdCBmaWxlUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChkaXJlY3R1c0ZpbGVFbmRwb2ludCwge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGJvZHk6IGZvcm0sXG4gICAgaGVhZGVyczogZmluYWxIZWFkZXJzXG4gIH0pO1xuXG4gIGlmICghZmlsZVJlc3BvbnNlLm9rKSB7XG4gICAgY29uc3QgZXJyb3JCb2R5ID0gYXdhaXQgZmlsZVJlc3BvbnNlLnRleHQoKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIHVwbG9hZGluZyBmaWxlOiAke2Vycm9yQm9keX1gKTtcbiAgfVxuXG4gIGNvbnN0IGRpcmVjdHVzUmVzcG9uc2UgPSBhd2FpdCBmaWxlUmVzcG9uc2UuanNvbigpO1xuXG4gIHJldHVybiBkaXJlY3R1c1Jlc3BvbnNlO1xufVxuXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVBcnRpY2xlV2l0aEF1ZGlvSWQoY29sbGVjdGlvbiwgaXRlbUlkLCBhdWRpb0ZpbGVJZCkge1xuICBjb25zdCBkaXJlY3R1c0l0ZW1FbmRwb2ludCA9IERJUkVDVFVTX1VSTCArICcvaXRlbXMvJyArIGNvbGxlY3Rpb24gKyAnLycgKyBpdGVtSWQ7XG5cbiAgY29uc3QgdXBkYXRlRGF0YSA9IHtcbiAgICBhdWRpb192ZXJzaW9uOiBhdWRpb0ZpbGVJZFxuICB9O1xuXG4gIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyArIERJUkVDVFVTX0FVVEhfVE9LRU5cbiAgfTtcblxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGRpcmVjdHVzSXRlbUVuZHBvaW50LCB7XG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHVwZGF0ZURhdGEpLFxuICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgfSk7XG5cbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIGNvbnN0IGVycm9yQm9keSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIHVwZGF0aW5nIGl0ZW06ICR7ZXJyb3JCb2R5fWApO1xuICB9XG5cbiAgY29uc3QganNvblJlc3BvbnNlID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICByZXR1cm4ganNvblJlc3BvbnNlO1xufVxuXG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChyZXEsIGNvbnRleHQpID0+IHtcbiAgY29uc3QgYm9keXJlcyA9IGF3YWl0IHJlcS5qc29uKCk7XG4gIGNvbnNvbGUubG9nKGJvZHlyZXMpO1xuICBhd2FpdCBydW5Qcm9jZXNzKGJvZHlyZXMpOyAvLyBTdGFydCB0aGUgcHJvY2VzcyB1c2luZyB0aGUgYm9keSBvZiB0aGUgcmVxdWVzdFxufTtcblxuXG4vLy8vLyBIRUxQRVIgLy8vLy8gXG4vLyBGdW5jdGlvbiB0byBleHRyYWN0IHRleHQgZnJvbSBIVE1MXG5mdW5jdGlvbiBleHRyYWN0VGV4dEZyb21IVE1MKGh0bWwpIHtcbiAgY29uc3QgZG9tID0gbmV3IEpTRE9NKGh0bWwpO1xuICBjb25zdCBkb2N1bWVudCA9IGRvbS53aW5kb3cuZG9jdW1lbnQ7XG5cbiAgZnVuY3Rpb24gd2Fsa05vZGUobm9kZSwgdGV4dCA9ICcnKSB7XG4gICAgLy8gU2tpcCBzY3JpcHQsIHN0eWxlLCBpbWcsIGFuZCBmaWdjYXB0aW9uIHRhZ3NcbiAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gMSAmJiBbJ1NDUklQVCcsICdTVFlMRScsICdJTUcnLCAnRklHQ0FQVElPTiddLmluY2x1ZGVzKG5vZGUudGFnTmFtZSkpIHtcbiAgICAgIHJldHVybiB0ZXh0O1xuICAgIH1cblxuICAgIGlmIChub2RlLm5vZGVUeXBlID09PSAzKSB7IC8vIFRleHQgbm9kZVxuICAgICAgdGV4dCArPSBub2RlLnRleHRDb250ZW50O1xuICAgIH0gZWxzZSBpZiAobm9kZS5ub2RlVHlwZSA9PT0gMSkgeyAvLyBFbGVtZW50XG4gICAgICBpZiAoWydQJywgJ0JSJywgJ0RJVicsICdMSScsICdIMScsICdIMicsICdIMycsICdINCcsICdINScsICdINiddLmluY2x1ZGVzKG5vZGUudGFnTmFtZSkpIHtcbiAgICAgICAgdGV4dCArPSBub2RlLnRleHRDb250ZW50ICsgJ1xcbic7IC8vIEFkZCBhIG5ld2xpbmUgZm9yIGJsb2NrLWxldmVsIGVsZW1lbnRzXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UgcmVjdXJzaXZlbHkgY2hlY2sgZm9yIHRleHQgbm9kZXNcbiAgICAgICAgZm9yIChjb25zdCBjaGlsZE5vZGUgb2Ygbm9kZS5jaGlsZE5vZGVzKSB7XG4gICAgICAgICAgdGV4dCA9IHdhbGtOb2RlKGNoaWxkTm9kZSwgdGV4dCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRleHQ7XG4gIH1cblxuICByZXR1cm4gd2Fsa05vZGUoZG9jdW1lbnQuYm9keSk7XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBzcGxpdCB0ZXh0IGludG8gY2h1bmtzIGJ5IHBhcmFncmFwaHMgb3Igc2VudGVuY2VzXG5mdW5jdGlvbiBzcGxpdFRleHQodGV4dCwgbWF4TGVuZ3RoKSB7XG4gIGNvbnN0IHNlbnRlbmNlRW5kaW5ncyA9IFsnLicsICchJywgJz8nXTsgLy8gU2VudGVuY2UgZW5kaW5nIGNoYXJhY3RlcnNcbiAgbGV0IGNodW5rcyA9IFtdO1xuICBsZXQgc3RhcnRJbmRleCA9IDA7XG5cbiAgd2hpbGUgKHN0YXJ0SW5kZXggPCB0ZXh0Lmxlbmd0aCkge1xuICAgIGxldCBlbmRJbmRleCA9IE1hdGgubWluKHN0YXJ0SW5kZXggKyBtYXhMZW5ndGgsIHRleHQubGVuZ3RoKTtcbiAgICBsZXQgbGFzdEJyZWFrSW5kZXggPSBzdGFydEluZGV4OyAvLyBTdG9yZSB0aGUgbGFzdCBpbmRleCBvZiBhIHNlbnRlbmNlIG9yIHBhcmFncmFwaCBicmVha1xuXG4gICAgLy8gTG9vayBmb3IgdGhlIGNsb3Nlc3Qgc2VudGVuY2Ugb3IgcGFyYWdyYXBoIGJyZWFrIHdpdGhpbiB0aGUgY3VycmVudCBjaHVua1xuICAgIGZvciAobGV0IGkgPSBzdGFydEluZGV4OyBpIDwgZW5kSW5kZXg7IGkrKykge1xuICAgICAgaWYgKHRleHRbaV0gPT09ICdcXG4nIHx8IChzZW50ZW5jZUVuZGluZ3MuaW5jbHVkZXModGV4dFtpXSkgJiYgdGV4dFtpICsgMV0gJiYgdGV4dFtpICsgMV0gPT09ICcgJykpIHtcbiAgICAgICAgbGFzdEJyZWFrSW5kZXggPSBpICsgMTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gSWYgYSBzZW50ZW5jZSBvciBwYXJhZ3JhcGggZW5kaW5nIHdhcyBmb3VuZCwgdXNlIGl0IGFzIHRoZSBzcGxpdCBwb2ludFxuICAgIGlmIChsYXN0QnJlYWtJbmRleCA+IHN0YXJ0SW5kZXgpIHtcbiAgICAgIGNodW5rcy5wdXNoKHRleHQuc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIGxhc3RCcmVha0luZGV4KSk7XG4gICAgICBzdGFydEluZGV4ID0gbGFzdEJyZWFrSW5kZXg7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIElmIG5vIHN1aXRhYmxlIGJyZWFrIHdhcyBmb3VuZCB3aXRoaW4gdGhlIG1heExlbmd0aCwgbG9vayBmb3IgdGhlIG5leHQgcG9zc2libGUgYnJlYWtcbiAgICAgIGxldCBuZXh0QnJlYWtJbmRleCA9IHRleHQuaW5kZXhPZignXFxuJywgZW5kSW5kZXgpIHx8IHRleHQubGVuZ3RoO1xuICAgICAgZm9yIChjb25zdCBlbmRpbmcgb2Ygc2VudGVuY2VFbmRpbmdzKSB7XG4gICAgICAgIGxldCBuZXh0U2VudGVuY2VJbmRleCA9IHRleHQuaW5kZXhPZihlbmRpbmcgKyAnICcsIGVuZEluZGV4KTtcbiAgICAgICAgaWYgKG5leHRTZW50ZW5jZUluZGV4ICE9PSAtMSAmJiAobmV4dFNlbnRlbmNlSW5kZXggPCBuZXh0QnJlYWtJbmRleCB8fCBuZXh0QnJlYWtJbmRleCA9PT0gLTEpKSB7XG4gICAgICAgICAgbmV4dEJyZWFrSW5kZXggPSBuZXh0U2VudGVuY2VJbmRleCArIDE7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gU3BsaXQgYXQgbmV4dEJyZWFrSW5kZXggb3IgYXQgdGhlIGVuZCBvZiB0ZXh0IGlmIG5vIGJyZWFrIGlzIGZvdW5kXG4gICAgICBuZXh0QnJlYWtJbmRleCA9IG5leHRCcmVha0luZGV4ICE9PSAtMSA/IG5leHRCcmVha0luZGV4IDogdGV4dC5sZW5ndGg7XG4gICAgICBjaHVua3MucHVzaCh0ZXh0LnN1YnN0cmluZyhzdGFydEluZGV4LCBuZXh0QnJlYWtJbmRleCkpO1xuICAgICAgc3RhcnRJbmRleCA9IG5leHRCcmVha0luZGV4O1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjaHVua3M7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrRXhpc3RpbmdGaWxlKGNvbGxlY3Rpb24sIGNvbGxlY3Rpb25JZCkge1xuICAvLyBEZWZpbmUgdGhlIGVuZHBvaW50IHRvIHNlYXJjaCBmb3IgZmlsZXMgd2l0aCB0aGUgc3BlY2lmaWVkIHRhZ3NcbiAgY29uc3QgcXVlcnkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAnZmlsdGVyW3RhZ3NdW19jb250YWluc10nOiBbY29sbGVjdGlvbiwgY29sbGVjdGlvbklkXS5qb2luKCcsJylcbiAgfSk7XG4gIGNvbnN0IGRpcmVjdHVzRmlsZVNlYXJjaEVuZHBvaW50ID0gRElSRUNUVVNfVVJMICsgJy9maWxlcz8nICsgcXVlcnkudG9TdHJpbmcoKTtcblxuICBjb25zdCBoZWFkZXJzID0ge1xuICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgRElSRUNUVVNfQVVUSF9UT0tFTlxuICB9O1xuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZGlyZWN0dXNGaWxlU2VhcmNoRW5kcG9pbnQsIHsgaGVhZGVycyB9KTtcbiAgXG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICBjb25zdCBlcnJvckJvZHkgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBzZWFyY2hpbmcgZm9yIGZpbGU6ICR7ZXJyb3JCb2R5fWApO1xuICB9XG5cbiAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgcmV0dXJuIGRhdGEuZGF0YSAmJiBkYXRhLmRhdGEubGVuZ3RoID4gMCA/IGRhdGEuZGF0YVswXSA6IG51bGw7XG59XG4iXSwKICAibWFwcGluZ3Mi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
