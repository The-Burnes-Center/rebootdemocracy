
import {createRequire as ___nfyCreateRequire} from "module";
import {fileURLToPath as ___nfyFileURLToPath} from "url";
import {dirname as ___nfyPathDirname} from "path";
let __filename=___nfyFileURLToPath(import.meta.url);
let __dirname=___nfyPathDirname(___nfyFileURLToPath(import.meta.url));
let require=___nfyCreateRequire(import.meta.url);


// netlify/functions/tts-background.mjs
import OpenAI from "openai";
import FormData from "form-data";
import fetch from "node-fetch";
import { JSDOM } from "jsdom";
var DIRECTUS_URL = process.env.DIRECTUS_URL;
var DIRECTUS_AUTH_TOKEN = process.env.DIRECTUS_AUTH_TOKEN;
var openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY
});
async function directusFetch(endpoint, method = "GET", body = null) {
  const url = `${DIRECTUS_URL}${endpoint}`;
  const headers = {
    "Authorization": `Bearer ${DIRECTUS_AUTH_TOKEN}`,
    "Content-Type": "application/json"
  };
  const options = {
    method,
    headers
  };
  if (body) {
    options.body = JSON.stringify(body);
  }
  const response = await fetch(url, options);
  if (!response.ok) {
    const errorDetails = await response.text();
    throw new Error(`Directus API request failed: ${response.status} - ${errorDetails}`);
  }
  return response.json();
}
async function readDirectusItem(collection, itemId) {
  const endpoint = `/items/${collection}/${itemId}?fields=*.*,authors.team_id.*`;
  return directusFetch(endpoint);
}
async function runProcess(bodyres) {
  try {
    let getFullName = function(author) {
      return `${author.team_id.First_Name} ${author.team_id.Last_Name}`;
    }, joinAuthorNames = function(authors2) {
      if (authors2.length === 1) {
        return getFullName(authors2[0]);
      } else {
        return authors2.map(getFullName).join(", ").replace(/, (?=[^,]+$)/, " and ");
      }
    };
    const article = await readDirectusItem(bodyres.collection, bodyres.id);
    const { content, slug, title, authors, audio_version } = article.data;
    let textContent = `${title} 
 ${joinAuthorNames(authors).length > 0 ? "\nby" : ""} ${joinAuthorNames(authors)} 
${extractTextFromHTML(content)}`;
    let allSpeechBuffers = [];
    if (textContent.length > 4096) {
      const chunks = splitText(textContent, 4096);
      for (const chunk of chunks) {
        console.log(chunk.length);
        const buffer = await generateSpeech(chunk);
        allSpeechBuffers.push(buffer);
      }
    } else {
      const buffer = await generateSpeech(textContent);
      allSpeechBuffers.push(buffer);
    }
    const combinedBuffer = Buffer.concat(allSpeechBuffers);
    const uploadResult = await uploadBuffer(combinedBuffer, slug, bodyres.collection, bodyres.id, audio_version);
    console.log(uploadResult);
    const updateResult = await updateArticleWithAudioId(bodyres.collection, bodyres.id, uploadResult.data.id);
    return updateResult;
  } catch (error) {
    console.error("Error in processing article and generating speech:", error);
  }
}
async function generateSpeech(text) {
  const response = await openai.audio.speech.create({
    model: "tts-1-hd",
    voice: "shimmer",
    input: text
  });
  if (response.status !== 200) {
    throw new Error("Failed to generate speech from OpenAI.");
  }
  const chunks = [];
  for await (const chunk of response.body) {
    chunks.push(chunk instanceof Buffer ? chunk : Buffer.from(chunk));
  }
  return Buffer.concat(chunks);
}
async function uploadBuffer(buffer, slug, audio_version) {
  const form = new FormData();
  form.append("file", buffer, {
    filename: slug + ".mp3",
    contentType: "audio/mpeg",
    knownLength: buffer.length
  });
  const directusFileEndpoint = DIRECTUS_URL + "/files" + (audio_version ? "/" + audio_version.id : "");
  const headers = {
    "Authorization": "Bearer " + DIRECTUS_AUTH_TOKEN
    // replace with an actual token
  };
  const finalHeaders = { ...form.getHeaders(), ...headers };
  const fileResponse = await fetch(directusFileEndpoint, {
    method: audio_version ? "PATCH" : "POST",
    body: form,
    headers: finalHeaders
  });
  if (!fileResponse.ok) {
    const errorBody = await fileResponse.text();
    throw new Error(`Error uploading file: ${errorBody}`);
  }
  const directusResponse = await fileResponse.json();
  return directusResponse;
}
async function updateArticleWithAudioId(collection, itemId, audioFileId) {
  const directusItemEndpoint = DIRECTUS_URL + "/items/" + collection + "/" + itemId;
  const updateData = {
    audio_version: audioFileId
  };
  const headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer " + DIRECTUS_AUTH_TOKEN
  };
  const response = await fetch(directusItemEndpoint, {
    method: "PATCH",
    body: JSON.stringify(updateData),
    headers
  });
  if (!response.ok) {
    const errorBody = await response.text();
    throw new Error(`Error updating item: ${errorBody}`);
  }
  const jsonResponse = await response.json();
  return jsonResponse;
}
var tts_background_default = async (req, context) => {
  const bodyres = await req.json();
  console.log(bodyres);
  await runProcess(bodyres);
};
function extractTextFromHTML(html) {
  const dom = new JSDOM(html);
  const document = dom.window.document;
  function walkNode(node, text = "") {
    if (node.nodeType === 1 && ["SCRIPT", "STYLE", "IMG", "FIGCAPTION"].includes(node.tagName)) {
      return text;
    }
    if (node.nodeType === 3) {
      text += node.textContent;
    } else if (node.nodeType === 1) {
      if (["P", "BR", "DIV", "LI", "H1", "H2", "H3", "H4", "H5", "H6"].includes(node.tagName)) {
        text += node.textContent + "\n";
      } else {
        for (const childNode of node.childNodes) {
          text = walkNode(childNode, text);
        }
      }
    }
    return text;
  }
  return walkNode(document.body);
}
function splitText(text, maxLength) {
  const sentenceEndings = [".", "!", "?"];
  let chunks = [];
  let startIndex = 0;
  while (startIndex < text.length) {
    let endIndex = Math.min(startIndex + maxLength, text.length);
    let lastBreakIndex = startIndex;
    for (let i = startIndex; i < endIndex; i++) {
      if (text[i] === "\n" || sentenceEndings.includes(text[i]) && text[i + 1] && text[i + 1] === " ") {
        lastBreakIndex = i + 1;
      }
    }
    if (lastBreakIndex > startIndex) {
      chunks.push(text.substring(startIndex, lastBreakIndex));
      startIndex = lastBreakIndex;
    } else {
      let nextBreakIndex = text.indexOf("\n", endIndex) || text.length;
      for (const ending of sentenceEndings) {
        let nextSentenceIndex = text.indexOf(ending + " ", endIndex);
        if (nextSentenceIndex !== -1 && (nextSentenceIndex < nextBreakIndex || nextBreakIndex === -1)) {
          nextBreakIndex = nextSentenceIndex + 1;
        }
      }
      nextBreakIndex = nextBreakIndex !== -1 ? nextBreakIndex : text.length;
      chunks.push(text.substring(startIndex, nextBreakIndex));
      startIndex = nextBreakIndex;
    }
  }
  return chunks;
}
export {
  tts_background_default as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibmV0bGlmeS9mdW5jdGlvbnMvdHRzLWJhY2tncm91bmQubWpzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgT3BlbkFJIGZyb20gJ29wZW5haSc7XG5pbXBvcnQgRm9ybURhdGEgZnJvbSAnZm9ybS1kYXRhJztcbmltcG9ydCBmZXRjaCBmcm9tICdub2RlLWZldGNoJztcbmltcG9ydCB7IEpTRE9NIH0gZnJvbSAnanNkb20nO1xuXG4vLyBDb25maWd1cmF0aW9uIHZhcmlhYmxlc1xuY29uc3QgRElSRUNUVVNfVVJMID0gcHJvY2Vzcy5lbnYuRElSRUNUVVNfVVJMXG5jb25zdCBESVJFQ1RVU19BVVRIX1RPS0VOID0gcHJvY2Vzcy5lbnYuRElSRUNUVVNfQVVUSF9UT0tFTlxuXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcbiAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSxcbn0pO1xuXG5cblxuLy8gRnVuY3Rpb24gdG8gbWFrZSByZXF1ZXN0cyB0byBEaXJlY3R1cyBBUElcbmFzeW5jIGZ1bmN0aW9uIGRpcmVjdHVzRmV0Y2goZW5kcG9pbnQsIG1ldGhvZCA9ICdHRVQnLCBib2R5ID0gbnVsbCkge1xuICBjb25zdCB1cmwgPSBgJHtESVJFQ1RVU19VUkx9JHtlbmRwb2ludH1gO1xuICBjb25zdCBoZWFkZXJzID0ge1xuICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke0RJUkVDVFVTX0FVVEhfVE9LRU59YCxcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICB9O1xuXG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgbWV0aG9kLFxuICAgIGhlYWRlcnMsXG4gIH07XG5cbiAgaWYgKGJvZHkpIHtcbiAgICBvcHRpb25zLmJvZHkgPSBKU09OLnN0cmluZ2lmeShib2R5KTtcbiAgfVxuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCBvcHRpb25zKTtcblxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgY29uc3QgZXJyb3JEZXRhaWxzID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIHRocm93IG5ldyBFcnJvcihgRGlyZWN0dXMgQVBJIHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c30gLSAke2Vycm9yRGV0YWlsc31gKTtcbiAgfVxuXG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5cbi8vIEZ1bmN0aW9uIHRvIHJlYWQgYW4gaXRlbSBmcm9tIGEgY29sbGVjdGlvbiBieSBJRFxuYXN5bmMgZnVuY3Rpb24gcmVhZERpcmVjdHVzSXRlbShjb2xsZWN0aW9uLCBpdGVtSWQpIHtcbiAgY29uc3QgZW5kcG9pbnQgPSBgL2l0ZW1zLyR7Y29sbGVjdGlvbn0vJHtpdGVtSWR9P2ZpZWxkcz0qLiosYXV0aG9ycy50ZWFtX2lkLipgO1xuICByZXR1cm4gZGlyZWN0dXNGZXRjaChlbmRwb2ludCk7XG59XG5cblxuLy8gTWFpbiBmdW5jdGlvbiB0byBydW4gdGhlIHByb2Nlc3NcbmFzeW5jIGZ1bmN0aW9uIHJ1blByb2Nlc3MoYm9keXJlcykge1xuICAvLyBhc3luYyBmdW5jdGlvbiBydW5Qcm9jZXNzKCkge1xuICAvLyAgdmFyICBib2R5cmVzPSB7Y29sbGVjdGlvbjpcInJlYm9vdF9kZW1vY3JhY3lfYmxvZ1wiLCBpZDpcIjI4MTgyXCJ9XG4gIHRyeSB7XG4gICAgLy8gUmVhZCBhbiBpdGVtIGZyb20gdGhlIERpcmVjdHVzIGNvbGxlY3Rpb24gd2l0aCB0aGUgc3BlY2lmaWVkIElEXG4gICAgY29uc3QgYXJ0aWNsZSA9IGF3YWl0IHJlYWREaXJlY3R1c0l0ZW0oYm9keXJlcy5jb2xsZWN0aW9uLCBib2R5cmVzLmlkKTtcblxuICAgIC8vIEV4dHJhY3QgdGhlIGNvbnRlbnQgYW5kIGRhdGUgdXBkYXRlZCBmcm9tIHRoZSBhcnRpY2xlXG4gICAgY29uc3QgeyBjb250ZW50LCBzbHVnLCB0aXRsZSAsIGF1dGhvcnMsIGF1ZGlvX3ZlcnNpb24gICB9ID0gYXJ0aWNsZS5kYXRhO1xuICBcbiAgXG4gICAgLy8gRnVuY3Rpb24gdG8gZXh0cmFjdCB0aGUgZnVsbCBuYW1lIGZyb20gYW4gYXV0aG9yIG9iamVjdFxuICAgICAgZnVuY3Rpb24gZ2V0RnVsbE5hbWUoYXV0aG9yKSB7XG4gICAgICAgIHJldHVybiBgJHthdXRob3IudGVhbV9pZC5GaXJzdF9OYW1lfSAke2F1dGhvci50ZWFtX2lkLkxhc3RfTmFtZX1gO1xuICAgICAgfVxuXG4gICAgICAvLyBGdW5jdGlvbiB0byBqb2luIGF1dGhvciBuYW1lcyB3aXRoIGNvbW1hcyBhbmQgXCJhbmRcIlxuICAgICAgZnVuY3Rpb24gam9pbkF1dGhvck5hbWVzKGF1dGhvcnMpIHtcbiAgICAgICAgaWYgKGF1dGhvcnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgLy8gT25seSBvbmUgYXV0aG9yLCBzbyBqdXN0IHJldHVybiB0aGUgZnVsbCBuYW1lXG4gICAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1lKGF1dGhvcnNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEpvaW4gbXVsdGlwbGUgYXV0aG9ycyB3aXRoIGNvbW1hcyBhbmQgcmVwbGFjZSB0aGUgbGFzdCBjb21tYSB3aXRoIFwiYW5kXCJcbiAgICAgICAgICByZXR1cm4gYXV0aG9ycy5tYXAoZ2V0RnVsbE5hbWUpLmpvaW4oJywgJykucmVwbGFjZSgvLCAoPz1bXixdKyQpLywgJyBhbmQgJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBcbiAgICBsZXQgdGV4dENvbnRlbnQgPSBgJHt0aXRsZX0gXFxuICR7am9pbkF1dGhvck5hbWVzKGF1dGhvcnMpLmxlbmd0aD4wPydcXG5ieSc6Jyd9ICR7am9pbkF1dGhvck5hbWVzKGF1dGhvcnMpfSBcXG4ke2V4dHJhY3RUZXh0RnJvbUhUTUwoY29udGVudCl9YDtcbiAgICBcbiAgICAvLyBBbiBhcnJheSB0byBob2xkIGFsbCBzcGVlY2ggYnVmZmVyc1xuICAgIGxldCBhbGxTcGVlY2hCdWZmZXJzID0gW107XG4gICAgXG4gICAgLy8gQ2hlY2sgdGhlIGNvbnRlbnQgbGVuZ3RoIGFuZCBzcGxpdCBpZiBuZWNlc3NhcnlcbiAgICBpZiAodGV4dENvbnRlbnQubGVuZ3RoID4gNDA5Nikge1xuICAgICAgY29uc3QgY2h1bmtzID0gc3BsaXRUZXh0KHRleHRDb250ZW50LCA0MDk2KTtcblxuICAgLy8gUHJvY2VzcyBlYWNoIGNodW5rIHRvIGdlbmVyYXRlIHNwZWVjaFxuICAgZm9yIChjb25zdCBjaHVuayBvZiBjaHVua3MpIHtcbiAgICBjb25zb2xlLmxvZyhjaHVuay5sZW5ndGgpO1xuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGdlbmVyYXRlU3BlZWNoKGNodW5rKTtcbiAgICBhbGxTcGVlY2hCdWZmZXJzLnB1c2goYnVmZmVyKTtcbiAgfVxuXG4gICAgICAvLyBmb3IgKGNvbnN0IGNodW5rIG9mIGNodW5rcykge1xuICAgICAgLy8gICBjb25zb2xlLmxvZyhjaHVuay5sZW5ndGgpO1xuICAgICAgLy8gICBhd2FpdCBnZW5lcmF0ZUFuZFVwbG9hZFNwZWVjaChjaHVuaywgZGF0ZV91cGRhdGVkLCBib2R5cmVzKTtcbiAgICAgIC8vIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYXdhaXQgZ2VuZXJhdGVBbmRVcGxvYWRTcGVlY2godGV4dF90b19zcGVlY2gsIGRhdGVfdXBkYXRlZCwgYm9keXJlcyk7XG4gICAgICBjb25zdCBidWZmZXIgPSBhd2FpdCBnZW5lcmF0ZVNwZWVjaCh0ZXh0Q29udGVudCk7XG4gICAgICBhbGxTcGVlY2hCdWZmZXJzLnB1c2goYnVmZmVyKTtcbiAgICB9XG4gICAgIC8vIENvbmNhdGVuYXRlIGFsbCBzcGVlY2ggYnVmZmVycyBpbnRvIGEgc2luZ2xlIGJ1ZmZlclxuICAgICBjb25zdCBjb21iaW5lZEJ1ZmZlciA9IEJ1ZmZlci5jb25jYXQoYWxsU3BlZWNoQnVmZmVycyk7XG5cbiAgICAgIC8vIFVwbG9hZCBjb21iaW5lZCBidWZmZXJcbiAgICAgIFxuICAgIGNvbnN0IHVwbG9hZFJlc3VsdCA9IGF3YWl0IHVwbG9hZEJ1ZmZlcihjb21iaW5lZEJ1ZmZlciwgc2x1ZywgYm9keXJlcy5jb2xsZWN0aW9uLCBib2R5cmVzLmlkLCBhdWRpb192ZXJzaW9uKTtcbiAgICBjb25zb2xlLmxvZyh1cGxvYWRSZXN1bHQpO1xuICAgICAgLy8gVXBkYXRlIHRoZSBhcnRpY2xlIHdpdGggdGhlIGF1ZGlvIGZpbGUgSURcbiAgICAgIGNvbnN0IHVwZGF0ZVJlc3VsdCA9IGF3YWl0IHVwZGF0ZUFydGljbGVXaXRoQXVkaW9JZChib2R5cmVzLmNvbGxlY3Rpb24sIGJvZHlyZXMuaWQsIHVwbG9hZFJlc3VsdC5kYXRhLmlkKTtcbiAgICAgIHJldHVybiB1cGRhdGVSZXN1bHQ7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBwcm9jZXNzaW5nIGFydGljbGUgYW5kIGdlbmVyYXRpbmcgc3BlZWNoOicsIGVycm9yKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVNwZWVjaCh0ZXh0KSB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmF1ZGlvLnNwZWVjaC5jcmVhdGUoe1xuICAgIG1vZGVsOiBcInR0cy0xLWhkXCIsXG4gICAgdm9pY2U6IFwic2hpbW1lclwiLFxuICAgIGlucHV0OiB0ZXh0LFxuICB9KTtcblxuICAvLyBDaGVjayB0aGUgcmVzcG9uc2UgaXMgT0tcbiAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgc3BlZWNoIGZyb20gT3BlbkFJLicpO1xuICB9XG5cbiAgLy8gQ29sbGVjdCBzdHJlYW0gZGF0YSBpbnRvIGEgYnVmZmVyIGZvciB0aGUgY2h1bmtcbiAgY29uc3QgY2h1bmtzID0gW107XG4gIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2YgcmVzcG9uc2UuYm9keSkge1xuICAgIGNodW5rcy5wdXNoKGNodW5rIGluc3RhbmNlb2YgQnVmZmVyID8gY2h1bmsgOiBCdWZmZXIuZnJvbShjaHVuaykpO1xuICB9XG4gIHJldHVybiBCdWZmZXIuY29uY2F0KGNodW5rcyk7IC8vIFJldHVybiB0aGUgc2luZ2xlIHNwZWVjaCBidWZmZXIgZm9yIG9uZSBjaHVua1xufVxuXG5hc3luYyBmdW5jdGlvbiB1cGxvYWRCdWZmZXIoYnVmZmVyLCBzbHVnLCBhdWRpb192ZXJzaW9uKSB7XG4gIC8vIENyZWF0ZSBmb3JtLWRhdGEgaW5zdGFuY2VcbiBcbiAgY29uc3QgZm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xuICBmb3JtLmFwcGVuZCgnZmlsZScsIGJ1ZmZlciwge1xuICAgIGZpbGVuYW1lOiBzbHVnICsgJy5tcDMnLFxuICAgIGNvbnRlbnRUeXBlOiAnYXVkaW8vbXBlZycsXG4gICAga25vd25MZW5ndGg6IGJ1ZmZlci5sZW5ndGhcbiAgfSk7XG5cbiAgY29uc3QgZGlyZWN0dXNGaWxlRW5kcG9pbnQgPSBESVJFQ1RVU19VUkwgKyAnL2ZpbGVzJyArIChhdWRpb192ZXJzaW9uPycvJythdWRpb192ZXJzaW9uLmlkOicnKSA7XG4gIFxuICAvLyBQcmVwYXJlIHRoZSByZXF1ZXN0IGhlYWRlcnMgd2l0aCB0aGUgQmVhcmVyIHRva2VuXG4gIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBESVJFQ1RVU19BVVRIX1RPS0VOLCAvLyByZXBsYWNlIHdpdGggYW4gYWN0dWFsIHRva2VuXG4gIH07XG5cbiAgLy8gTWVyZ2UgdGhlIGhlYWRlcnMgZnJvbSBmb3JtLWRhdGEgd2l0aCBEaXJlY3R1cyB0b2tlblxuICBjb25zdCBmaW5hbEhlYWRlcnMgPSB7IC4uLmZvcm0uZ2V0SGVhZGVycygpLCAuLi5oZWFkZXJzIH07XG5cbiAgLy8gTWFrZSB0aGUgcmVxdWVzdCB0byBEaXJlY3R1cyB0byB1cGxvYWQgdGhlIGZpbGVcbiAgY29uc3QgZmlsZVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZGlyZWN0dXNGaWxlRW5kcG9pbnQsIHtcbiAgICBtZXRob2Q6IGF1ZGlvX3ZlcnNpb24/J1BBVENIJzonUE9TVCcsXG4gICAgYm9keTogZm9ybSxcbiAgICBoZWFkZXJzOiBmaW5hbEhlYWRlcnNcbiAgfSk7XG5cbiAgaWYgKCFmaWxlUmVzcG9uc2Uub2spIHtcbiAgICBjb25zdCBlcnJvckJvZHkgPSBhd2FpdCBmaWxlUmVzcG9uc2UudGV4dCgpO1xuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgdXBsb2FkaW5nIGZpbGU6ICR7ZXJyb3JCb2R5fWApO1xuICB9XG5cbiAgY29uc3QgZGlyZWN0dXNSZXNwb25zZSA9IGF3YWl0IGZpbGVSZXNwb25zZS5qc29uKCk7XG5cbiAgcmV0dXJuIGRpcmVjdHVzUmVzcG9uc2U7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUFydGljbGVXaXRoQXVkaW9JZChjb2xsZWN0aW9uLCBpdGVtSWQsIGF1ZGlvRmlsZUlkKSB7XG4gIGNvbnN0IGRpcmVjdHVzSXRlbUVuZHBvaW50ID0gRElSRUNUVVNfVVJMICsgJy9pdGVtcy8nICsgY29sbGVjdGlvbiArICcvJyArIGl0ZW1JZDtcblxuICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgIGF1ZGlvX3ZlcnNpb246IGF1ZGlvRmlsZUlkXG4gIH07XG5cbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgRElSRUNUVVNfQVVUSF9UT0tFTlxuICB9O1xuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZGlyZWN0dXNJdGVtRW5kcG9pbnQsIHtcbiAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkodXBkYXRlRGF0YSksXG4gICAgaGVhZGVyczogaGVhZGVyc1xuICB9KTtcblxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgY29uc3QgZXJyb3JCb2R5ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgdXBkYXRpbmcgaXRlbTogJHtlcnJvckJvZHl9YCk7XG4gIH1cblxuICBjb25zdCBqc29uUmVzcG9uc2UgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gIHJldHVybiBqc29uUmVzcG9uc2U7XG59XG5cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKHJlcSwgY29udGV4dCkgPT4ge1xuICBjb25zdCBib2R5cmVzID0gYXdhaXQgcmVxLmpzb24oKTtcbiAgY29uc29sZS5sb2coYm9keXJlcyk7XG4gIGF3YWl0IHJ1blByb2Nlc3MoYm9keXJlcyk7IC8vIFN0YXJ0IHRoZSBwcm9jZXNzIHVzaW5nIHRoZSBib2R5IG9mIHRoZSByZXF1ZXN0XG59O1xuXG5cbi8vLy8vIEhFTFBFUiAvLy8vLyBcbi8vIEZ1bmN0aW9uIHRvIGV4dHJhY3QgdGV4dCBmcm9tIEhUTUxcbmZ1bmN0aW9uIGV4dHJhY3RUZXh0RnJvbUhUTUwoaHRtbCkge1xuICBjb25zdCBkb20gPSBuZXcgSlNET00oaHRtbCk7XG4gIGNvbnN0IGRvY3VtZW50ID0gZG9tLndpbmRvdy5kb2N1bWVudDtcblxuICBmdW5jdGlvbiB3YWxrTm9kZShub2RlLCB0ZXh0ID0gJycpIHtcbiAgICAvLyBTa2lwIHNjcmlwdCwgc3R5bGUsIGltZywgYW5kIGZpZ2NhcHRpb24gdGFnc1xuICAgIGlmIChub2RlLm5vZGVUeXBlID09PSAxICYmIFsnU0NSSVBUJywgJ1NUWUxFJywgJ0lNRycsICdGSUdDQVBUSU9OJ10uaW5jbHVkZXMobm9kZS50YWdOYW1lKSkge1xuICAgICAgcmV0dXJuIHRleHQ7XG4gICAgfVxuXG4gICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHsgLy8gVGV4dCBub2RlXG4gICAgICB0ZXh0ICs9IG5vZGUudGV4dENvbnRlbnQ7XG4gICAgfSBlbHNlIGlmIChub2RlLm5vZGVUeXBlID09PSAxKSB7IC8vIEVsZW1lbnRcbiAgICAgIGlmIChbJ1AnLCAnQlInLCAnRElWJywgJ0xJJywgJ0gxJywgJ0gyJywgJ0gzJywgJ0g0JywgJ0g1JywgJ0g2J10uaW5jbHVkZXMobm9kZS50YWdOYW1lKSkge1xuICAgICAgICB0ZXh0ICs9IG5vZGUudGV4dENvbnRlbnQgKyAnXFxuJzsgLy8gQWRkIGEgbmV3bGluZSBmb3IgYmxvY2stbGV2ZWwgZWxlbWVudHNcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE90aGVyd2lzZSByZWN1cnNpdmVseSBjaGVjayBmb3IgdGV4dCBub2Rlc1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkTm9kZSBvZiBub2RlLmNoaWxkTm9kZXMpIHtcbiAgICAgICAgICB0ZXh0ID0gd2Fsa05vZGUoY2hpbGROb2RlLCB0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGV4dDtcbiAgfVxuXG4gIHJldHVybiB3YWxrTm9kZShkb2N1bWVudC5ib2R5KTtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHNwbGl0IHRleHQgaW50byBjaHVua3MgYnkgcGFyYWdyYXBocyBvciBzZW50ZW5jZXNcbmZ1bmN0aW9uIHNwbGl0VGV4dCh0ZXh0LCBtYXhMZW5ndGgpIHtcbiAgY29uc3Qgc2VudGVuY2VFbmRpbmdzID0gWycuJywgJyEnLCAnPyddOyAvLyBTZW50ZW5jZSBlbmRpbmcgY2hhcmFjdGVyc1xuICBsZXQgY2h1bmtzID0gW107XG4gIGxldCBzdGFydEluZGV4ID0gMDtcblxuICB3aGlsZSAoc3RhcnRJbmRleCA8IHRleHQubGVuZ3RoKSB7XG4gICAgbGV0IGVuZEluZGV4ID0gTWF0aC5taW4oc3RhcnRJbmRleCArIG1heExlbmd0aCwgdGV4dC5sZW5ndGgpO1xuICAgIGxldCBsYXN0QnJlYWtJbmRleCA9IHN0YXJ0SW5kZXg7IC8vIFN0b3JlIHRoZSBsYXN0IGluZGV4IG9mIGEgc2VudGVuY2Ugb3IgcGFyYWdyYXBoIGJyZWFrXG5cbiAgICAvLyBMb29rIGZvciB0aGUgY2xvc2VzdCBzZW50ZW5jZSBvciBwYXJhZ3JhcGggYnJlYWsgd2l0aGluIHRoZSBjdXJyZW50IGNodW5rXG4gICAgZm9yIChsZXQgaSA9IHN0YXJ0SW5kZXg7IGkgPCBlbmRJbmRleDsgaSsrKSB7XG4gICAgICBpZiAodGV4dFtpXSA9PT0gJ1xcbicgfHwgKHNlbnRlbmNlRW5kaW5ncy5pbmNsdWRlcyh0ZXh0W2ldKSAmJiB0ZXh0W2kgKyAxXSAmJiB0ZXh0W2kgKyAxXSA9PT0gJyAnKSkge1xuICAgICAgICBsYXN0QnJlYWtJbmRleCA9IGkgKyAxO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBJZiBhIHNlbnRlbmNlIG9yIHBhcmFncmFwaCBlbmRpbmcgd2FzIGZvdW5kLCB1c2UgaXQgYXMgdGhlIHNwbGl0IHBvaW50XG4gICAgaWYgKGxhc3RCcmVha0luZGV4ID4gc3RhcnRJbmRleCkge1xuICAgICAgY2h1bmtzLnB1c2godGV4dC5zdWJzdHJpbmcoc3RhcnRJbmRleCwgbGFzdEJyZWFrSW5kZXgpKTtcbiAgICAgIHN0YXJ0SW5kZXggPSBsYXN0QnJlYWtJbmRleDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWYgbm8gc3VpdGFibGUgYnJlYWsgd2FzIGZvdW5kIHdpdGhpbiB0aGUgbWF4TGVuZ3RoLCBsb29rIGZvciB0aGUgbmV4dCBwb3NzaWJsZSBicmVha1xuICAgICAgbGV0IG5leHRCcmVha0luZGV4ID0gdGV4dC5pbmRleE9mKCdcXG4nLCBlbmRJbmRleCkgfHwgdGV4dC5sZW5ndGg7XG4gICAgICBmb3IgKGNvbnN0IGVuZGluZyBvZiBzZW50ZW5jZUVuZGluZ3MpIHtcbiAgICAgICAgbGV0IG5leHRTZW50ZW5jZUluZGV4ID0gdGV4dC5pbmRleE9mKGVuZGluZyArICcgJywgZW5kSW5kZXgpO1xuICAgICAgICBpZiAobmV4dFNlbnRlbmNlSW5kZXggIT09IC0xICYmIChuZXh0U2VudGVuY2VJbmRleCA8IG5leHRCcmVha0luZGV4IHx8IG5leHRCcmVha0luZGV4ID09PSAtMSkpIHtcbiAgICAgICAgICBuZXh0QnJlYWtJbmRleCA9IG5leHRTZW50ZW5jZUluZGV4ICsgMTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBTcGxpdCBhdCBuZXh0QnJlYWtJbmRleCBvciBhdCB0aGUgZW5kIG9mIHRleHQgaWYgbm8gYnJlYWsgaXMgZm91bmRcbiAgICAgIG5leHRCcmVha0luZGV4ID0gbmV4dEJyZWFrSW5kZXggIT09IC0xID8gbmV4dEJyZWFrSW5kZXggOiB0ZXh0Lmxlbmd0aDtcbiAgICAgIGNodW5rcy5wdXNoKHRleHQuc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIG5leHRCcmVha0luZGV4KSk7XG4gICAgICBzdGFydEluZGV4ID0gbmV4dEJyZWFrSW5kZXg7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGNodW5rcztcbn1cblxuYXN5bmMgZnVuY3Rpb24gY2hlY2tFeGlzdGluZ0ZpbGUoY29sbGVjdGlvbiwgY29sbGVjdGlvbklkKSB7XG4gIC8vIERlZmluZSB0aGUgZW5kcG9pbnQgdG8gc2VhcmNoIGZvciBmaWxlcyB3aXRoIHRoZSBzcGVjaWZpZWQgdGFnc1xuICBjb25zdCBxdWVyeSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICdmaWx0ZXJbdGFnc11bX2NvbnRhaW5zXSc6IFtjb2xsZWN0aW9uLCBjb2xsZWN0aW9uSWRdLmpvaW4oJywnKVxuICB9KTtcbiAgY29uc3QgZGlyZWN0dXNGaWxlU2VhcmNoRW5kcG9pbnQgPSBESVJFQ1RVU19VUkwgKyAnL2ZpbGVzPycgKyBxdWVyeS50b1N0cmluZygpO1xuXG4gIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBESVJFQ1RVU19BVVRIX1RPS0VOXG4gIH07XG5cbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChkaXJlY3R1c0ZpbGVTZWFyY2hFbmRwb2ludCwgeyBoZWFkZXJzIH0pO1xuICBcbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIGNvbnN0IGVycm9yQm9keSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIHNlYXJjaGluZyBmb3IgZmlsZTogJHtlcnJvckJvZHl9YCk7XG4gIH1cblxuICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICByZXR1cm4gZGF0YS5kYXRhICYmIGRhdGEuZGF0YS5sZW5ndGggPiAwID8gZGF0YS5kYXRhWzBdIDogbnVsbDtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7QUFBQSxPQUFPLFlBQVk7QUFDbkIsT0FBTyxjQUFjO0FBQ3JCLE9BQU8sV0FBVztBQUNsQixTQUFTLGFBQWE7QUFHdEIsSUFBTSxlQUFlLFFBQVEsSUFBSTtBQUNqQyxJQUFNLHNCQUFzQixRQUFRLElBQUk7QUFFeEMsSUFBTSxTQUFTLElBQUksT0FBTztBQUFBLEVBQ3hCLFFBQVEsUUFBUSxJQUFJO0FBQ3RCLENBQUM7QUFLRCxlQUFlLGNBQWMsVUFBVSxTQUFTLE9BQU8sT0FBTyxNQUFNO0FBQ2xFLFFBQU0sTUFBTSxHQUFHLFlBQVksR0FBRyxRQUFRO0FBQ3RDLFFBQU0sVUFBVTtBQUFBLElBQ2QsaUJBQWlCLFVBQVUsbUJBQW1CO0FBQUEsSUFDOUMsZ0JBQWdCO0FBQUEsRUFDbEI7QUFFQSxRQUFNLFVBQVU7QUFBQSxJQUNkO0FBQUEsSUFDQTtBQUFBLEVBQ0Y7QUFFQSxNQUFJLE1BQU07QUFDUixZQUFRLE9BQU8sS0FBSyxVQUFVLElBQUk7QUFBQSxFQUNwQztBQUVBLFFBQU0sV0FBVyxNQUFNLE1BQU0sS0FBSyxPQUFPO0FBRXpDLE1BQUksQ0FBQyxTQUFTLElBQUk7QUFDaEIsVUFBTSxlQUFlLE1BQU0sU0FBUyxLQUFLO0FBQ3pDLFVBQU0sSUFBSSxNQUFNLGdDQUFnQyxTQUFTLE1BQU0sTUFBTSxZQUFZLEVBQUU7QUFBQSxFQUNyRjtBQUVBLFNBQU8sU0FBUyxLQUFLO0FBQ3ZCO0FBR0EsZUFBZSxpQkFBaUIsWUFBWSxRQUFRO0FBQ2xELFFBQU0sV0FBVyxVQUFVLFVBQVUsSUFBSSxNQUFNO0FBQy9D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QUMxRixhQUFPO0FBQUEsSUFDVDtBQUVBLFFBQUksS0FBSyxhQUFhLEdBQUc7QUFDdkIsY0FBUSxLQUFLO0FBQUEsSUFDZixXQUFXLEtBQUssYUFBYSxHQUFHO0FBQzlCLFVBQUksQ0FBQyxLQUFLLE1BQU0sT0FBTyxNQUFNLE1BQU0sTUFBTSxNQUFNLE1BQU0sTUFBTSxJQUFJLEVBQUUsU0FBUyxLQUFLLE9BQU8sR0FBRztBQUN2RixnQkFBUSxLQUFLLGNBQWM7QUFBQSxNQUM3QixPQUFPO0FBRUwsbUJBQVcsYUFBYSxLQUFLLFlBQVk7QUFDdkMsaUJBQU8sU0FBUyxXQUFXLElBQUk7QUFBQSxRQUNqQztBQUFBLE1BQ0Y7QUFBQSxJQUNGO0FBQ0EsV0FBTztBQUFBLEVBQ1Q7QUFFQSxTQUFPLFNBQVMsU0FBUyxJQUFJO0FBQy9CO0FBR0EsU0FBUyxVQUFVLE1BQU0sV0FBVztBQUNsQyxRQUFNLGtCQUFrQixDQUFDLEtBQUssS0FBSyxHQUFHO0FBQ3RDLE1BQUksU0FBUyxDQUFDO0FBQ2QsTUFBSSxhQUFhO0FBRWpCLFNBQU8sYUFBYSxLQUFLLFFBQVE7QUFDL0IsUUFBSSxXQUFXLEtBQUssSUFBSSxhQUFhLFdBQVcsS0FBSyxNQUFNO0FBQzNELFFBQUksaUJBQWlCO0FBR3JCLGFBQVMsSUFBSSxZQUFZLElBQUksVUFBVSxLQUFLO0FBQzFDLFVBQUksS0FBSyxDQUFDLE1BQU0sUUFBUyxnQkFBZ0IsU0FBUyxLQUFLLENBQUMsQ0FBQyxLQUFLLEtBQUssSUFBSSxDQUFDLEtBQUssS0FBSyxJQUFJLENBQUMsTUFBTSxLQUFNO0FBQ2pHLHlCQUFpQixJQUFJO0FBQUEsTUFDdkI7QUFBQSxJQUNGO0FBR0EsUUFBSSxpQkFBaUIsWUFBWTtBQUMvQixhQUFPLEtBQUssS0FBSyxVQUFVLFlBQVksY0FBYyxDQUFDO0FBQ3RELG1CQUFhO0FBQUEsSUFDZixPQUFPO0FBRUwsVUFBSSxpQkFBaUIsS0FBSyxRQUFRLE1BQU0sUUFBUSxLQUFLLEtBQUs7QUFDMUQsaUJBQVcsVUFBVSxpQkFBaUI7QUFDcEMsWUFBSSxvQkFBb0IsS0FBSyxRQUFRLFNBQVMsS0FBSyxRQUFRO0FBQzNELFlBQUksc0JBQXNCLE9BQU8sb0JBQW9CLGtCQUFrQixtQkFBbUIsS0FBSztBQUM3RiwyQkFBaUIsb0JBQW9CO0FBQUEsUUFDdkM7QUFBQSxNQUNGO0FBR0EsdUJBQWlCLG1CQUFtQixLQUFLLGlCQUFpQixLQUFLO0FBQy9ELGFBQU8sS0FBSyxLQUFLLFVBQVUsWUFBWSxjQUFjLENBQUM7QUFDdEQsbUJBQWE7QUFBQSxJQUNmO0FBQUEsRUFDRjtBQUVBLFNBQU87QUFDVDsiLAogICJuYW1lcyI6IFsiYXV0aG9ycyJdCn0K
